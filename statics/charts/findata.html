<!DOCTYPE html>
<html>
  <head>
    <title>Chart</title>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <style>
      html,
      body {
        height: 100%;
      }

      body {
        margin: 0;
      }
    </style>
  </head>

  <body>
    <!-- TradingView Widget BEGIN -->
    <div class="tradingview-widget-container" id="tradingview">
      <!-- <script
        type="text/javascript"
        src="https://s3.tradingview.com/external-embedding/embed-widget-financials.js"
        async
      >

           {
              "symbol": "ADBE",
              "colorTheme": "light",
              "isTransparent": false,
              "largeChartUrl": "",
              "displayMode": "regular",
              "width": "100%",        
              "height": "100%",
              "locale": "zh_TW"
            }
      </script> -->
    </div>
    <script>
      window.onload = function() {
        let url = new URL(location.href);
        let stockid = url.searchParams.get("stockId");
        let stockCode = {
          symbol: stockid,
          colorTheme: "light",
          isTransparent: false,
          largeChartUrl: "",
          displayMode: "regular",
          width: "100%",
          height: "100%",
          locale: "zh_TW"
        };

        var t = document.getElementById("tradingview");
        var jst = document.createElement("script");
        jst.setAttribute("type", "text/javascript");
        jst.setAttribute("async", true);
        jst.innerText = JSON.stringify(stockCode);
        jst.setAttribute(
          "src",
          "https://s3.tradingview.com/external-embedding/embed-widget-financials.js"
        );
        t.appendChild(jst);
        // console.log(t);
        // setTimeout(() => {
        //   var iframe = t.getElementsByTagName('iframe');
        //   console.log(iframe);

        //   var parent = iframe[0].contentWindow.document.getElementsByClassName(
        //     "tv-embed-widget-wrapper__body"
        //   );
        //   console.log(parent);
        //   var children = parent[0].querySelectorAll("a");
        //   console.log(children);
        //   if (children.length > 0) {
        //     children.forEach(e => {
        //       // e.remove();
        //     });
        //   }
        // }, 3000);
      };
    </script>
    <!-- TradingView Widget END -->
  </body>
</html>
